schema
root
 |-- bigram: string (nullable = true)
 |-- year: integer (nullable = true)
 |-- count: integer (nullable = true)
 |-- pages: integer (nullable = true)
 |-- books: integer (nullable = true)

####################
10 rows
+--------+----+-----+-----+-----+
|  bigram|year|count|pages|books|
+--------+----+-----+-----+-----+
|! $17.95|1985|    1|    1|    1|
|! $17.95|1987|    1|    1|    1|
|! $17.95|1990|    1|    1|    1|
|! $17.95|1991|    1|    1|    1|
|! $17.95|1992|    5|    5|    5|
|! $17.95|1993|    2|    2|    2|
|! $17.95|1995|    1|    1|    1|
|! $17.95|1996|    4|    2|    2|
|! $17.95|1997|    6|    5|    5|
|! $17.95|1998|    4|    3|    3|
+--------+----+-----+-----+-----+
only showing top 10 rows

####################
3.1) Return all bigrams where the Count is greater than five
sql
+--------+----+-----+-----+-----+
|  bigram|year|count|pages|books|
+--------+----+-----+-----+-----+
|! $17.95|1997|    6|    5|    5|
|! $17.95|1999|   11|   10|   10|
|! $17.95|2000|   11|    9|    9|
|! $17.95|2004|   14|   14|   14|
|! $17.95|2005|   13|   13|   13|
|    ! 09|1899|    6|    6|    5|
|    ! 09|1916|    7|    7|    4|
|    ! 09|1936|    6|    6|    6|
|    ! 09|1997|    6|    5|    5|
|    ! 09|1999|   11|   10|   10|
+--------+----+-----+-----+-----+
only showing top 10 rows

None
sparksql
+--------+----+-----+-----+-----+
|  bigram|year|count|pages|books|
+--------+----+-----+-----+-----+
|! $17.95|1997|    6|    5|    5|
|! $17.95|1999|   11|   10|   10|
|! $17.95|2000|   11|    9|    9|
|! $17.95|2004|   14|   14|   14|
|! $17.95|2005|   13|   13|   13|
|    ! 09|1899|    6|    6|    5|
|    ! 09|1916|    7|    7|    4|
|    ! 09|1936|    6|    6|    6|
|    ! 09|1997|    6|    5|    5|
|    ! 09|1999|   11|   10|   10|
+--------+----+-----+-----+-----+
only showing top 10 rows

None
####################
3.2) Return the total number of bigrams for each year.
sql
+----+------------+
|year|total_bigram|
+----+------------+
|1829|           1|
|1990|           2|
|1903|           1|
|1884|           1|
|1888|           1|
|1924|           1|
|2003|           2|
|1823|           1|
|2007|           2|
|1869|           1|
+----+------------+
only showing top 10 rows

None
sparksql
+----+------------+
|year|total_bigram|
+----+------------+
|1829|           1|
|1990|           2|
|1903|           1|
|1884|           1|
|1888|           1|
|1924|           1|
|2003|           2|
|1823|           1|
|2007|           2|
|1869|           1|
+----+------------+
only showing top 10 rows

None
####################
3.3) Return the bigrams with the highest Count for each year.
sql
+----+--------+---------+
|year|  bigram|max_count|
+----+--------+---------+
|2002|    ! 09|        5|
|1932|    ! 09|        1|
|1880|    ! 09|        2|
|1935|    ! 09|        2|
|1999|    ! 09|       11|
|1829|    ! 09|        3|
|1999|! $17.95|       11|
|1887|    ! 09|        1|
|2007|    ! 09|        2|
|1899|    ! 09|        6|
+----+--------+---------+
only showing top 10 rows

None
sparksql
+----+--------+----------+
|year|  bigram|max(count)|
+----+--------+----------+
|2002|    ! 09|         5|
|1932|    ! 09|         1|
|1880|    ! 09|         2|
|1935|    ! 09|         2|
|1999|    ! 09|        11|
|1829|    ! 09|         3|
|1999|! $17.95|        11|
|1887|    ! 09|         1|
|2007|    ! 09|         2|
|1899|    ! 09|         6|
+----+--------+----------+
only showing top 10 rows

None
####################
3.4) Return all bigrams that appeared in 20 different years.
sql
+--------+
|  bigram|
+--------+
|! $17.95|
+--------+

None
sparksql
+--------+-------------+
|  bigram|distinct_year|
+--------+-------------+
|! $17.95|           20|
+--------+-------------+

None
####################
3.5) Return all bigrams that contain the character '!' in the first part and the character '9' in the second part (the two parts are separated by a space).
sql
+----+--------+
|year|  bigram|
+----+--------+
|1985|! $17.95|
|1987|! $17.95|
|1990|! $17.95|
|1991|! $17.95|
|1992|! $17.95|
|1993|! $17.95|
|1995|! $17.95|
|1996|! $17.95|
|1997|! $17.95|
|1998|! $17.95|
+----+--------+
only showing top 10 rows

None
sparksql
+----+--------+
|year|  bigram|
+----+--------+
|1985|! $17.95|
|1987|! $17.95|
|1990|! $17.95|
|1991|! $17.95|
|1992|! $17.95|
|1993|! $17.95|
|1995|! $17.95|
|1996|! $17.95|
|1997|! $17.95|
|1998|! $17.95|
+----+--------+
only showing top 10 rows

None
####################
3.6) Return the bigrams that appeared in all the years present in the dataset.
sql
+------+
|bigram|
+------+
|  ! 09|
+------+

None
sparksql
+------+-------------+
|bigram|distinct_year|
+------+-------------+
|  ! 09|          100|
+------+-------------+

None
####################
3.7) Return the total number of pages and books in which each bigram appeared for each available year, sorted in alphabetical order.
sql
+----+--------+-----------+-----------+
|year|  bigram|total_pages|total_books|
+----+--------+-----------+-----------+
|2000|! $17.95|          9|          9|
|2008|! $17.95|          2|          2|
|1995|! $17.95|          1|          1|
|1997|! $17.95|          5|          5|
|2007|! $17.95|          2|          2|
|1985|! $17.95|          1|          1|
|1996|! $17.95|          2|          2|
|1999|! $17.95|         10|         10|
|2006|! $17.95|          5|          5|
|2002|! $17.95|          5|          5|
+----+--------+-----------+-----------+
only showing top 10 rows

None
sparksql
+----+--------+-----------+-----------+
|year|  bigram|total_pages|total_books|
+----+--------+-----------+-----------+
|1991|! $17.95|          1|          1|
|2007|! $17.95|          2|          2|
|1995|! $17.95|          1|          1|
|2008|! $17.95|          2|          2|
|1985|! $17.95|          1|          1|
|1999|! $17.95|         10|         10|
|1996|! $17.95|          2|          2|
|2002|! $17.95|          5|          5|
|2006|! $17.95|          5|          5|
|1997|! $17.95|          5|          5|
+----+--------+-----------+-----------+
only showing top 10 rows

None
####################
3.8) Return the total number of distinct bigrams for each year, sorted in descending order of the year.
sql
+----+---------------+
|year|distinct_bigram|
+----+---------------+
|2008|              2|
|2007|              2|
|2006|              2|
|2005|              2|
|2004|              2|
|2003|              2|
|2002|              2|
|2001|              2|
|2000|              2|
|1999|              2|
+----+---------------+
only showing top 10 rows

None
sparksql
+----+---------------+
|year|distinct_bigram|
+----+---------------+
|2008|              2|
|2007|              2|
|2006|              2|
|2005|              2|
|2004|              2|
|2003|              2|
|2002|              2|
|2001|              2|
|2000|              2|
|1999|              2|
+----+---------------+
only showing top 10 rows

None